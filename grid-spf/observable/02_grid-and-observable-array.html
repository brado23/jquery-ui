<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Grid: Observable Array</title>
	<link rel="stylesheet" href="../../themes/base/jquery.ui.all.css"/>
	<link rel="stylesheet" href="../grid.css"/>
	<link href="editable.css" rel="stylesheet"/>
	<script src="../../jquery-1.5.1.js"></script>
	<script src="jquery.observable.js" type="text/javascript"></script>
	<script src="jquery.render.js" type="text/javascript"></script>
	<script src="jquery.views.js" type="text/javascript"></script>
	<script src="../../ui/jquery.ui.core.js"></script>
	<script src="../../ui/jquery.ui.widget2.js"></script>
	<script src="../grid.js"></script>

	<script>

	var developersInput, developersDataGrid;

	$.ajax({
		dataType: "json",
		url: "../developers.json",
		async: false,
		success: function( result ) {
			developersInput = result;
		}
	});

	$( function() {
		developersDataGrid = $( "#developers-data" ).grid({
			selectMode: "single",
			columns: [ "firstName", "lastName", "country" ],
			source: developersInput
		}).data( "grid" );

		developersDataGrid.select( 0 );

		function deleteSelectedDeveloper() {
			var selectedItem = developersDataGrid.options.selectedItem;
			if ( selectedItem ) {
				var prevIndex = selectedItem.index;
				$.observable( developersInput ).splice( prevIndex, 1 );
				developersDataGrid.select( prevIndex );
			}
		}

		$("#addDeveloper" ).click( function () {
			var selectedItem = developersDataGrid.options.selectedItem,
				insertAt = selectedItem ? selectedItem.index : developersDataGrid.options.viewItems.length,
				addedData = {
					firstName: "firstName",
					lastName: "lastName",
					country: "country"
				};
			$.observable( developersInput ).splice( insertAt, 0, addedData );
			developersDataGrid.select( insertAt );
		});

		$( "#deleteDeveloper" ).click( function () {
			deleteSelectedDeveloper();
		});
	});
	</script>
</head>
<body>

<h1>Grid with observable array</h1>

<p>
	<button id="addDeveloper" >Insert developer</button>
	<button id="deleteDeveloper" >Delete selected developer</button>
</p>
<table id="developers-data">
	<thead>
		<tr>
			<th data-field="firstName">First Name</th>
			<th data-field="lastName">Last Name</th>
			<th data-field="country">Country</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
</table>
</body>
</html>
